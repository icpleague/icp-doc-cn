<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Rust Canister 开发安全最佳实践 :: Motoko documentation</title>
    <meta name="generator" content="Antora 3.0.1">
<link rel="stylesheet" href="../../_/css/site.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" /><meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
<meta property="og:title" content="Internet Computer | Documentation" />
<meta property="og:description" content="Documentation for the internet computer." />
<meta property="og:image" content="../../_/img/share.jpg" />
<meta property="og:image:url" content="../../_/img/share.jpg" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@DFINITYDev" />
<meta name="twitter:image" content="../../_/img/logo-RGB.png" />
<meta name="twitter:image:alt" content="ICPL Logo" />
    <script>
        if (location.hostname === 'sdk.dfinity.org') {
            location.replace(location.href.replace("sdk.dfinity.org","smartcontracts.org"));
        }
    </script>


    <!-- Appzi: Capture Insightful Feedback -->
    <script async src="https://w.appzi.io/w.js?token=Zrf92"></script>
    <!-- End Appzi -->

    <link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<script>
  function switchToLightMode(persist) {
    document.querySelector("body").classList.remove("dark-mode");
    if (persist) {
      localStorage.setItem("theme-preference", "light");
    }
  }
  function switchToDarkMode(persist) {
    document.querySelector("body").classList.add("dark-mode");
    if (persist) {
      localStorage.setItem("theme-preference", "dark");
    }
  }

  var themePreference = localStorage.getItem("theme-preference");

  if (themePreference == "dark") {
    switchToDarkMode(false);
  } else if (themePreference == "light") {
    switchToLightMode(false);
  } else {
    // dark mode by default
    switchToDarkMode(false);

    // uncomment to enable setting the defult by user preference
    // try {
    //   if (
    //     window.matchMedia &&
    //     window.matchMedia("(prefers-color-scheme: dark)").matches
    //   ) {
    //     switchToDarkMode(false);
    //   }
    // } catch {}
  }
</script>
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="logo-container" href="/icp-docs-cn/docs/introduction/welcome.html">
        <img class="header-logo" src="../../_/img/logo.svg">
        <img class="header-logo dark" src="../../_/img/logo-dark.svg">
        <h1 class="header-title">Motoko documentation</h1>
      </a>
    </div>
    <div id="topbar-nav" class="navbar-menu">
          <!--<a class="navbar-item" target="blank" href="https://dfinity.org/">DFINITY.org</a>-->
          <a class="navbar-item" target="blank" href="https://icpleague.com/">论坛</a>
          <!--<a class="navbar-item" target="blank" href="mailto:support@dfinity.org?subject=Feedback - SDK Developer Center">Email us</a>-->
          <!--<a class="navbar-item" target="blank" href="https://support.dfinity.org/">Support</a>          -->
          <a class="navbar-item" target="blank" href="https://twitter.com/icpleague_com">
            <img class="light-only" src="../../_/img/social/twitter-icon.svg">
            <img class="dark-only" src="../../_/img/social/twitter-icon-dark.svg">
          </a>
      </div>
    <div class="nav-items-wrapper">
      <button class="to-light-mode dark-only" aria-label="switch to light mode" onclick="switchToLightMode(true)"></button>
      <button class="to-dark-mode light-only" aria-label="switch to dark mode" onclick="switchToDarkMode(true)"></button>
      <div class="search-container">
  <svg class="search-icon" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path fill-rule="evenodd" clip-rule="evenodd"
      d="M11.8654 12.5892C10.8213 13.4695 9.47259 14 8 14C4.68629 14 2 11.3137 2 8C2 4.68629 4.68629 2 8 2C11.3137 2 14 4.68629 14 8C14 9.47209 13.4699 10.8204 12.5901 11.8643L17.3625 16.6367L16.6377 17.3615L11.8654 12.5892ZM12.9333 8C12.9333 10.7246 10.7246 12.9333 8 12.9333C5.2754 12.9333 3.06667 10.7246 3.06667 8C3.06667 5.2754 5.2754 3.06667 8 3.06667C10.7246 3.06667 12.9333 5.2754 12.9333 8Z"
      fill="black" />
  </svg>


  <input class="search-input" placeholder="Search" type="search" />
</div>      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
      </div>

    <div class="gradient-decoration"></div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="docs" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title">Docs</h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../introduction/welcome.html"><strong>介绍</strong></a>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/welcome.html#for-first-timers">适合: 初学者</a>
    
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/welcome.html#for-developers">适合: 开发者</a>
    
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/welcome.html#for-protocol-enthusiasts">适合: 协议爱好者</a>
    
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../quickstart/quickstart-intro.html">快速开始</a>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../quickstart/how-to-deploy-hello-world-smart-contract.html">20分钟部署第一个DAPP</a>
    
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../quickstart/cycles-faucet.html">获取免费的Cycles</a>
    
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../examples/index.html">示例代码</a>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../examples/hello.html">Hello示例</a>
    
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../examples/host-a-website.html">静态网站</a>
    
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../examples/dex.html">Basic DEX</a>
    
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../examples/nft.html">NFT Minting</a>
    
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../examples/dao.html">Basic DAO</a>
    
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../examples/encrypted-notes.html">Encrypted Note-taking</a>
    
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../examples/tokentransfer.html">Token Transfer</a>
    
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">开发者文档</span>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">入门</span>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">SDK介绍</span>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../developers-guide/install-upgrade-remove.html">安装、升级或删除软件</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../release-notes/sdk-release-notes.html">Release notes</a>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../release-notes/0.9.2-rn.html">0.9.2</a>
    
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../release-notes/0.9.0-rn.html">0.9.0</a>
    
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../release-notes/0.8.4-rn.html">0.8.4</a>
    
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../release-notes/0.8.3-rn.html">0.8.3</a>
    
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../release-notes/0.8.2-rn.html">0.8.2</a>
    
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../release-notes/0.8.1-rn.html">0.8.1</a>
    
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../release-notes/0.8.0-rn.html">0.8.0</a>
    
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../release-notes/0.7.7-rn.html">0.7.7</a>
    
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../release-notes/0.7.2-rn.html">0.7.2</a>
    
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../release-notes/0.7.1-rn.html">0.7.1</a>
    
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../release-notes/0.7.0-rn.html">0.7.0</a>
    
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../release-notes/0.6.26-rn.html">0.6.26</a>
    
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../release-notes/0.6.25-rn.html">0.6.25</a>
    
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../release-notes/0.6.24-rn.html">0.6.24</a>
    
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../release-notes/0.6.23-rn.html">0.6.23</a>
    
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../release-notes/0.6.22-rn.html">0.6.22</a>
    
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../release-notes/0.6.21-rn.html">0.6.21</a>
    
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../release-notes/0.6.20-rn.html">0.6.20</a>
    
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">DFX介绍</span>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../developers-guide/cli-reference.html">DFX命令</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../developers-guide/cli-reference/dfx-envars.html">DFX环境变量</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../developers-guide/glossary.html">术语表</a>
    
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">在互联网计算机上构建</span>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">了解如何构建:</span>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../developers-guide/sdk-guide.html">在IC上开发智能合约</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../developers-guide/design-apps.html">设计应用程序</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../developers-guide/customize-projects.html">管理项目</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../developers-guide/working-with-canisters.html">管理容器</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../developers-guide/default-wallet.html">使用默认的cycles钱包</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../developers-guide/tutorials/explore-templates.html">探索默认项目</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../developers-guide/tutorials/define-an-actor.html">使用actor查询</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../developers-guide/tutorials/hello-location.html">传递text参数</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../developers-guide/tutorials/counter-tutorial.html">递增自然数</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../developers-guide/tutorials/calculator.html">在计算器函数中使用整型</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../developers-guide/tutorials/phonebook.html">导入库模块</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../developers-guide/tutorials/multiple-actors.html">使用多个actor</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../developers-guide/tutorials/intercanister-calls.html">进行canister之间调用</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../developers-guide/tutorials/access-control.html">使用身份添加访问控制</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../developers-guide/tutorials/simple-cycles.html">从钱包接受cycles</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../developers-guide/tutorials/reproducible-builds.html">可重复地构建容器</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../developers-guide/troubleshooting.html">故障排查</a>
    
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">探索开发语言</span>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../developers-guide/work-with-languages.html">使用不同的语言进行开发</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../language-guide/motoko.html">Motoko</a>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="https://m7sm4-2iaaa-aaaab-qabra-cai.raw.ic0.app/">Motoko在线环境</a>
    
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="#base-libraries:stdlib-intro.adoc">Motoko基础库</a>
    
  </li>
  <li class="nav-item" data-depth="5">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Motoko Guide</span>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../language-guide/about-this-guide.html">关于本指南</a>
    
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../language-guide/motoko-introduction.html">介绍</a>
    
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../language-guide/basic-concepts.html">基本概念和术语</a>
    
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../language-guide/mutable-state.html">可变状态</a>
    
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../language-guide/local-objects-classes.html">本地对象和类</a>
    
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../language-guide/actors-async.html">Actors和异步数据</a>
    
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../language-guide/errors.html">错误处理</a>
    
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../language-guide/pattern-matching.html">模式匹配</a>
    
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../language-guide/sharing.html">共享数据和行为</a>
    
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../language-guide/modules-and-imports.html">模块和导入</a>
    
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../language-guide/control-flow.html">(命令式)控制流</a>
    
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../language-guide/structural-equality.html">结构方程(平等)</a>
    
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../language-guide/actor-classes.html">Actor类</a>
    
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../language-guide/caller-id.html">Principals和调用者身份</a>
    
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../language-guide/cycles.html">管理cycles</a>
    
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../language-guide/upgrades.html">稳定变量与upgrade方法</a>
    
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../language-guide/compatibility.html">更新升级的兼容性</a>
    
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../language-guide/stablememory.html">稳定存储(实验性)</a>
    
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../language-guide/heartbeats.html">心跳机制(定时任务)</a>
    
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../language-guide/language-manual.html">语言速览手册</a>
    
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../language-guide/compiler-ref.html">编译器手册</a>
    
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../language-guide/motoko-grammar.html">Motoko语法</a>
    
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../language-guide/overview.html">Motoko简介</a>
    
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../language-guide/style.html">Motoko编程规范</a>
    
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="#rust-guide:rust-intro.adoc">Rust</a>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="#rust-guide:rust-quickstart.adoc">快速开始</a>
    
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="#rust-guide:rust-counter.adoc">简单的计数器</a>
    
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="#rust-guide:multiply-dependency.adoc">基础依赖</a>
    
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="#rust-guide:rust-profile.adoc">简介</a>
    
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="#rust-guide:rust-optimize.adoc">优化Rust程序</a>
    
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="#candid-guide:candid-intro.adoc">Candid</a>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="#candid-guide:candid-concepts.adoc">什么是Candid?</a>
    
  </li>
  <li class="nav-item" data-depth="5">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="#candid-guide:candid-howto.adoc">如何使用</a>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="#candid-guide:candid-types.adoc">支持的类型</a>
    
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="https://github.com/dfinity/candid">Candid规范</a>
    
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="https://docs.rs/candid">Candid的Rust库</a>
    
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">介绍互联网身份</span>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="#ic-identity-guide:what-is-ic-identity.adoc">什么是互联网身份</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="#ic-identity-guide:auth-how-to.adoc">如何使用互联网身份</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="#ic-identity-guide:hello-guide.adoc">Windows Hello指南</a>
    
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">前端开发</span>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../developers-guide/webpack-config.html">添加前端资源</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../developers-guide/tutorials/custom-frontend.html">自定义前端</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../developers-guide/tutorials/my-contacts.html">添加CSS样式</a>
    
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Security Best Practices</span>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="introduction.html">Introduction</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="general-security-best-practices.html">General Security Best Practices</a>
    
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="web-app-development-security-best-practices.html">Web App Development Security Best Practices</a>
    
  </li>
  <li class="nav-item is-current-page" data-depth="4">
    <a class="nav-link" href="rust-canister-development-security-best-practices.html">Rust Canister Development Security Best Practices</a>
    
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">协议文档</span>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../developers-guide/concepts/concepts-intro.html">概念</a>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../developers-guide/concepts/what-is-IC.html">什么是IC(互联网计算机)</a>
    
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#interface-spec:index.adoc">互联网计算机接口规范</a>
    
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../developers-guide/concepts/nodes-subnets.html">节点和子网络</a>
    
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../developers-guide/concepts/data-centers.html">去中心化数据中心</a>
    
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../developers-guide/concepts/canisters-code.html">Canister和代码</a>
    
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../developers-guide/concepts/trust-in-canisters.html">信任canister</a>
    
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../developers-guide/concepts/tokens-cycles.html">代币和cycles</a>
    
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../developers-guide/concepts/governance.html">神经元和治理</a>
    
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../developers-guide/concepts/bitcoin-integration.html">比特币整合</a>
    
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">通用文档</span>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Overview of self-custody</span>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../token-holders/custody-options-intro.html">Choosing self-custody for digital assets</a>
    
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../token-holders/self-custody-quickstart.html">Self-custody quick start</a>
    
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">账本概述</span>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../integration/ledger-quick-start.html">账本快速开始</a>
    
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">NNS概述</span>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../token-holders/nns-app-quickstart.html">NNS应用快速开始</a>
    
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">其他资源</span>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">开发者视频</span>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <span class="nav-text"><a href="https://www.youtube.com/watch?v=oxEr8UzGeBo&amp;list=PLuhDt1vhGcrf4DgKZecU3ar_RA1cB0vUT&amp;index=11&amp;ab_channel=DFINITY" target="_blank" rel="noopener">Internet Identity</a></span>
    
  </li>
  <li class="nav-item" data-depth="3">
    <span class="nav-text"><a href="https://www.youtube.com/watch?v=4eSceDOS-Ms&amp;list=PLuhDt1vhGcrf4DgKZecU3ar_RA1cB0vUT&amp;index=21&amp;ab_channel=DFINITY" target="_blank" rel="noopener">Motoko</a></span>
    
  </li>
  <li class="nav-item" data-depth="3">
    <span class="nav-text"><a href="https://www.youtube.com/watch?v=GzkRsbqPaA0&amp;ab_channel=DFINITY" target="_blank" rel="noopener">Building a multiplayer game for the Internet Computer</a></span>
    
  </li>
  <li class="nav-item" data-depth="3">
    <span class="nav-text"><a href="https://www.youtube.com/watch?v=b_nc6yx5_DQ&amp;list=PLuhDt1vhGcrf4DgKZecU3ar_RA1cB0vUT&amp;index=7&amp;ab_channel=DFINITY" target="_blank" rel="noopener">Deploying static sites to the Internet Computer</a></span>
    
  </li>
  <li class="nav-item" data-depth="3">
    <span class="nav-text"><a href="https://www.youtube.com/watch?v=2miweY9-vZc&amp;list=PLuhDt1vhGcrf4DgKZecU3ar_RA1cB0vUT&amp;index=6&amp;ab_channel=DFINITY" target="_blank" rel="noopener">Zero to fullstack: web apps on the Internet Computer </a></span>
    
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">协议视频</span>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <span class="nav-text"><a href="https://dfinity.org/technicals/" target="_blank" rel="noopener">Technical library</a></span>
    
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">开发者工具</span>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../download.html">DFINITY Canister SDK</a>
    
  </li>
  <li class="nav-item" data-depth="3">
    <span class="nav-text"><a href="https://github.com/dfinity/cdk-rs" target="_blank" rel="noopener">Rust CDK</a></span>
    
  </li>
  <li class="nav-item" data-depth="3">
    <span class="nav-text"><a href="https://github.com/kritzcreek/vessel" target="_blank" rel="noopener">Vessel Package Manager</a></span>
    
  </li>
  <li class="nav-item" data-depth="3">
    <span class="nav-text"><a href="https://marketplace.visualstudio.com/items?itemName=dfinity-foundation.vscode-motoko" target="_blank" rel="noopener">Motoko VS Code Extension</a></span>
    
  </li>
  <li class="nav-item" data-depth="3">
    <span class="nav-text"><a href="https://github.com/dfinity/agent-js" target="_blank" rel="noopener">Agent JS</a></span>
    
  </li>
  <li class="nav-item" data-depth="3">
    <span class="nav-text"><a href="https://github.com/sudograph/sudograph" target="_blank" rel="noopener">Sudograph</a></span>
    
  </li>
  <li class="nav-item" data-depth="3">
    <span class="nav-text"><a href="https://github.com/dfinity/cycles-wallet" target="_blank" rel="noopener">Cycles Wallet</a></span>
    
  </li>
  <li class="nav-item" data-depth="3">
    <span class="nav-text"><a href="https://m7sm4-2iaaa-aaaab-qabra-cai.raw.ic0.app/" target="_blank" rel="noopener">Motoko Playground</a></span>
    
  </li>
  <li class="nav-item" data-depth="3">
    <span class="nav-text"><a href="https://github.com/dfinity/quill" target="_blank" rel="noopener">Quill</a></span>
    
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">社区资源</span>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <span class="nav-text"><a href="https://ic.rocks/" target="_blank" rel="noopener">ic.rocks (Block explorer)</a></span>
    
  </li>
  <li class="nav-item" data-depth="3">
    <span class="nav-text"><a href="https://plugwallet.ooo/" target="_blank" rel="noopener">Plug (Browser-based wallet extension)</a></span>
    
  </li>
  <li class="nav-item" data-depth="3">
    <span class="nav-text"><a href="https://fleek.co/" target="_blank" rel="noopener">Fleek (Netlify for the open web)</a></span>
    
  </li>
  <li class="nav-item" data-depth="3">
    <span class="nav-text"><a href="http://faucet.dfinity.org/" target="_blank" rel="noopener">Cycles Faucet</a></span>
    
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../developers-guide/computation-and-storage-costs.html">Computation and Storage Costs</a>
    
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">社区</span>
    
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-text"><a href="https://discord.gg/cA7y6ezyE2" target="_blank" rel="noopener">Developer Discord</a></span>
    
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text"><a href="https://forum.dfinity.org/" target="_blank" rel="noopener">Developer Forum</a></span>
    
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Developer Center</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Developer Center</span>
      <ul class="versions">
        <li class="version is-current">
          <a href="../index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main>
<div class="toolbar" role="navigation">
<button class="nav-toggle">Table of contents</button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Developer Center</a></li>
    <li>开发者文档</li>
    <li>在互联网计算机上构建</li>
    <li>Security Best Practices</li>
    <li><a href="rust-canister-development-security-best-practices.html">Rust Canister Development Security Best Practices</a></li>
  </ul>
</nav>
</div>
<div class="main-content">
<article class="doc">
<h1 class="page">Rust Canister 开发安全最佳实践</h1>
<div class="sect1">
<h2 id="_不可变的智能合约"><a class="anchor" href="#_不可变的智能合约"></a>不可变的智能合约</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_使用像sns这样的去中心化治理系统让canister拥有去中心化的控制器"><a class="anchor" href="#_使用像sns这样的去中心化治理系统让canister拥有去中心化的控制器"></a>使用像SNS这样的去中心化治理系统，让canister拥有去中心化的控制器</h3>
<div class="sect3">
<h4 id="_安全问题"><a class="anchor" href="#_安全问题"></a>安全问题</h4>
<div class="paragraph">
<p>容器的控制者可以随时改变/更新容器。如果一个容器储存了ICP等资产，这实际上意味着控制者可以通过更新容器来窃取这些资产，并将燃料费转移到他们的账户。</p>
</div>
</div>
<div class="sect3">
<h4 id="_建议"><a class="anchor" href="#_建议"></a>建议</h4>
<div class="ulist">
<ul>
<li>
<p>要实现不可变的容器智能合约，你不能成为容器的控制者。控制权必须传递给服务神经系统（SNS）或一个去中心化的治理系统。</p>
</li>
<li>
<p>创建不可变的容器智能合约的另一个选择，是完全删除容器控制器。但请注意，这意味着容器不能被升级，这可能会产生严重的影响，例如发现一个错误。</p>
</li>
<li>
<p>请注意，与其他一些区块链相反，不可变的智能合约也需要燃料费来运行，而且它们可以接收燃料费。</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_验证您所依赖的智能合约的不变性"><a class="anchor" href="#_验证您所依赖的智能合约的不变性"></a>验证您所依赖的智能合约的不变性</h3>
<div class="sect3">
<h4 id="_安全问题_2"><a class="anchor" href="#_安全问题_2"></a>安全问题</h4>
<div class="paragraph">
<p>如果容器依赖容器智能合约（即对其进行容器间调用），容器智能合约必须是不可变的。 否则，即如果它有一个控制器，他们可以随时修改智能合约，例如 窃取容器持有的资产。</p>
</div>
</div>
<div class="sect3">
<h4 id="_推荐"><a class="anchor" href="#_推荐"></a>推荐</h4>
<div class="paragraph">
<p>如果您与必须不可变智能合约的容器进行交互，请确保它由 NNS、服务神经系统 (SNS) 或去中心化治理系统控制。</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_身份验证"><a class="anchor" href="#_身份验证"></a>身份验证</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_确保只有特定用户才能执行的任何操作都需要身份验证"><a class="anchor" href="#_确保只有特定用户才能执行的任何操作都需要身份验证"></a>确保只有特定用户才能执行的任何操作都需要身份验证</h3>
<div class="sect3">
<h4 id="_安全问题_3"><a class="anchor" href="#_安全问题_3"></a>安全问题</h4>
<div class="paragraph">
<p>如果不是这种情况，攻击者可能能够代表用户执行敏感操作，从而危及他们的帐户。</p>
</div>
</div>
<div class="sect3">
<h4 id="_推荐_2"><a class="anchor" href="#_推荐_2"></a>推荐</h4>
<div class="ulist">
<ul>
<li>
<p>根据设计，对于每个容器调用，都可以识别调用者。 调用link：https://smartcontracts.org/docs/interface-spec/index.html#principal[principal] 可以使用系统API的方法`ic0.msg_caller_size`和`ic0.msg_caller_copy`访问（见link：https ://docs.dfinity.systems/spec/public/#system-api-imports[这里]）。 如果例如 使用Internet Identity，principal是这个特定来源的用户身份，见link：https://github.com/dfinity/internet-identity/blob/main/docs/internet-identity-spec.adoc#identity-design -和数据模型[这里]。 如果某些操作（例如访问用户帐户数据或帐户特定操作）应限制为一个主体或一组主体，则必须在容器调用中明确检查，例如 Rust 中的如下：</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">    // Let pk be the public key of a principal that is allowed to perform
    // this operation. This pk could be stored in the canister's state.
    if caller() != Principal::self_authenticating(pk) {  ic_cdk::trap(...) }

    // Alternatively, if the canister keeps data for different principals
    // in e.g. a map such as BTreeMap&lt;Principal, UserData&gt;, then the canister
    // must ensure that each caller can only access and perform operations
    // on their own data:
    if let Some(user_data) = user_data_store.get_mut(&amp;caller()) {
    	// perform operations on the user's data
    }</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>在 Rust 中，<code>ic_cdk</code> crate 可用于使用 <code>ic_cdk::api::caller</code> 对调用者进行身份验证。 确保返回的主体是 <code>Principal::self_authenticating</code> 类型，并使用该主体的公钥识别用户帐户，请参见上面的示例代码。</p>
</li>
<li>
<p>在调用中尽早进行身份验证，以避免在身份验证之前进行未经身份验证的操作和潜在的昂贵操作。 link：rust-canister-development-security-best-practices.adoc#disallow-the-anonymous-principal[拒绝向匿名用户提供服务] 也是一个好主意。</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="disallow-the-anonymous-principal"><a class="anchor" href="#disallow-the-anonymous-principal"></a>在经过身份验证的调用中禁止匿名主体</h3>
<div class="sect3">
<h4 id="_安全问题_4"><a class="anchor" href="#_安全问题_4"></a>安全问题</h4>
<div class="paragraph">
<p><code>ic0::api::caller</code> 也可能返回 <code>Principal::anonymous()</code>。 在经过身份验证的呼叫中，这可能是不希望的（并且可能具有安全隐患），因为对于进行未经身份验证的呼叫的任何人来说，这就像一个共享帐户。</p>
</div>
</div>
<div class="sect3">
<h4 id="_推荐_3"><a class="anchor" href="#_推荐_3"></a>推荐</h4>
<div class="paragraph">
<p>在经过身份验证的调用中，确保调用者不是匿名的，如果是则返回错误或陷阱。 这可以例如 通过使用辅助方法集中完成，例如：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">fn caller() -&gt; Result&lt;Principal, String&gt; {
    let caller = ic0::api::caller();
    // The anonymous principal is not allowed to interact with canister.
    if caller == Principal::anonymous() {
        Err(String::from(
            "Anonymous principal not allowed to make calls.",
        ))
    } else {
        Ok(caller)
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_资产认证"><a class="anchor" href="#_资产认证"></a>资产认证</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_使用_http_资产认证并避免通过_raw_ic0_app_为您的_dapp_提供服务"><a class="anchor" href="#_使用_http_资产认证并避免通过_raw_ic0_app_为您的_dapp_提供服务"></a>使用 HTTP 资产认证并避免通过 <code>raw.ic0.app</code> 为您的 dApp 提供服务</h3>
<div class="sect3">
<h4 id="_安全问题_5"><a class="anchor" href="#_安全问题_5"></a>安全问题</h4>
<div class="paragraph">
<p>IC 上的 dApp 可以使用link：https://wiki.internetcomputer.org/wiki/HTTP_asset_certification[资产认证] 来确保交付给浏览器的 HTTP 资产是真实的（即由子网进行阈值签名）。 如果一个应用程序不做资产认证，它只能通过不检查资产认证的 <code>raw.ic0.app</code> 不安全地提供服务。 这是不安全的，因为单个恶意节点或边界节点可以自由修改传递给浏览器的资产。</p>
</div>
<div class="paragraph">
<p>如果除 <code>ic0.app</code> 之外还通过 <code>raw.ic0.app</code> 提供应用程序，则攻击者可能会诱骗用户（网络钓鱼）使用不安全的 raw.ic0.app。</p>
</div>
</div>
<div class="sect3">
<h4 id="_推荐_4"><a class="anchor" href="#_推荐_4"></a>推荐</h4>
<div class="ulist">
<ul>
<li>
<p>仅通过服务工作者验证资产认证的 <code>&lt;canister-id&gt;.ic0.app</code> 提供资产。 不要通过 <code>&lt;canister-id&gt;.raw.ic0.app</code> 提供服务。</p>
</li>
<li>
<p>使用资产容器（自动创建资产认证）提供资产，或添加包括资产认证的“ic-certificate”标头，例如 完成link：https://github.com/dfinity/nns-dapp[NNS dApp] 或link：https://github.com/dfinity/internet-identity[Internet Identity]。</p>
</li>
<li>
<p>如果请求来自原始，请检查容器的 <code>http_request</code> 方法。 如果是这样，则返回错误并且不提供任何资产。</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_容器存储"><a class="anchor" href="#_容器存储"></a>容器存储</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_使用_thread_local_和_cellrefcell_作为状态变量并将所有全局变量放在一个篮子中"><a class="anchor" href="#_使用_thread_local_和_cellrefcell_作为状态变量并将所有全局变量放在一个篮子中"></a>使用 <code>thread_local!</code> 和 <code>Cell/RefCell</code> 作为状态变量，并将所有全局变量放在一个篮子中。</h3>
<div class="sect3">
<h4 id="_安全问题_6"><a class="anchor" href="#_安全问题_6"></a>安全问题</h4>
<div class="paragraph">
<p>容器需要全局可变状态。 在 Rust 中，有几种方法可以实现这一点。 但是，某些选项可能会导致，例如 到内存损坏。</p>
</div>
</div>
<div class="sect3">
<h4 id="_推荐_5"><a class="anchor" href="#_推荐_5"></a>推荐</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://mmapped.blog/posts/01-effective-rust-canisters.html#use-threadlocal">Use <code>thread_local!</code> with <code>Cell/RefCell</code> for state variables.</a> (from <a href="https://mmapped.blog/posts/01-effective-rust-canisters.html">Effective Rust Canisters</a>)</p>
</li>
<li>
<p><a href="https://mmapped.blog/posts/01-effective-rust-canisters.html#clear-state">Put all your globals in one basket.</a> (from <a href="https://mmapped.blog/posts/01-effective-rust-canisters.html">Effective Rust Canisters</a>)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_限制每个用户可以存储在容器中的数据量"><a class="anchor" href="#_限制每个用户可以存储在容器中的数据量"></a>限制每个用户可以存储在容器中的数据量</h3>
<div class="sect3">
<h4 id="_安全问题_7"><a class="anchor" href="#_安全问题_7"></a>安全问题</h4>
<div class="paragraph">
<p>如果用户能够在容器上存储大量数据，这可能会被滥用以填满容器存储并使容器无法使用。</p>
</div>
</div>
<div class="sect3">
<h4 id="_推荐_6"><a class="anchor" href="#_推荐_6"></a>推荐</h4>
<div class="paragraph">
<p>限制每个用户可以存储在容器中的数据量。 每当在更新调用中为用户存储数据时，都必须检查此限制。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_考虑使用稳定的内存版本测试"><a class="anchor" href="#_考虑使用稳定的内存版本测试"></a>考虑使用稳定的内存，版本，测试</h3>
<div class="sect3">
<h4 id="_安全问题_8"><a class="anchor" href="#_安全问题_8"></a>安全问题</h4>
<div class="paragraph">
<p>容器内存不会在升级过程中保持不变。 如果需要在升级期间保留数据，很自然的做法是在 <code>pre_upgrade</code> 中序列化容器内存，并在 <code>post_upgrade</code> 中对其进行反序列化。 但是，这些方法的可用指令数量是有限的。 如果内存增长过大，则无法再更新容器。</p>
</div>
</div>
<div class="sect3">
<h4 id="_推荐_7"><a class="anchor" href="#_推荐_7"></a>推荐</h4>
<div class="ulist">
<ul>
<li>
<p>稳定内存在升级过程中保持不变，可用于解决此问题。</p>
</li>
<li>
<p><a href="https://mmapped.blog/posts/01-effective-rust-canisters.html#stable-memory-main">Consider using stable memory.</a> (from <a href="https://mmapped.blog/posts/01-effective-rust-canisters.html">Effective Rust Canisters</a>). See also the disadvantages discussed there.</p>
</li>
<li>
<p><a href="https://mmapped.blog/posts/01-effective-rust-canisters.html#version-stable-memory">Version stable memory.</a> (from <a href="https://mmapped.blog/posts/01-effective-rust-canisters.html">Effective Rust Canisters</a>)</p>
</li>
<li>
<p><a href="https://mmapped.blog/posts/01-effective-rust-canisters.html#test-upgrades">Test the upgrade hooks.</a> (from <a href="https://mmapped.blog/posts/01-effective-rust-canisters.html">Effective Rust Canisters</a>)</p>
</li>
<li>
<p>See also the section on upgrades in <a href="https://www.joachim-breitner.de/blog/788-How_to_audit_an_Internet_Computer_canister">How to audit an Internet Computer canister</a> (though focused on Motoko)</p>
</li>
<li>
<p>Write tests for stable memory to avoid bugs.</p>
</li>
<li>
<p>Some libraries (mostly work in progress / partly unfinished) that people work on:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/dfinity/stable-structures/">https://github.com/dfinity/stable-structures/</a></p>
<div class="ulist">
<ul>
<li>
<p>HashMap: <a href="https://github.com/dfinity/stable-structures/pull/1">https://github.com/dfinity/stable-structures/pull/1</a> (currently not prod ready)</p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="https://github.com/seniorjoinu/ic-stable-memory-allocator">https://github.com/seniorjoinu/ic-stable-memory-allocator</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>请参阅link：https://wiki.internetcomputer.org/wiki/Current_limitations_of_the_Internet_Computer[Internet 计算机的当前限制]，“长期运行升级”和“需要额外 wasm 内存的 [de]serializer”部分</p>
</li>
<li>
<p>例如link：https://github.com/dfinity/internet-identity[internet identity] 直接使用稳定内存存储用户数据。</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_考虑加密容器上的敏感数据"><a class="anchor" href="#_考虑加密容器上的敏感数据"></a>考虑加密容器上的敏感数据</h3>
<div class="sect3">
<h4 id="_安全问题_9"><a class="anchor" href="#_安全问题_9"></a>安全问题</h4>
<div class="paragraph">
<p>默认情况下，容器提供完整性但不提供机密性。 存储在容器上的数据可以被节点/副本读取。</p>
</div>
</div>
<div class="sect3">
<h4 id="_推荐_8"><a class="anchor" href="#_推荐_8"></a>推荐</h4>
<div class="ulist">
<ul>
<li>
<p>考虑对容器上的任何私人或个人数据（例如用户的个人或私人信息）进行端到端加密。</p>
</li>
<li>
<p>我们目前正在开发一个示例 dApp（加密笔记）来说明如何进行端到端加密。</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_创建备份"><a class="anchor" href="#_创建备份"></a>创建备份</h3>
<div class="sect3">
<h4 id="_安全问题_10"><a class="anchor" href="#_安全问题_10"></a>安全问题</h4>
<div class="paragraph">
<p>容器可能会变得不可用，因此它永远无法再次升级，例如 由于以下原因：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>它有一个错误的升级过程（由于 dapp 开发人员的一些错误）。</p>
</li>
<li>
<p>由于持久化数据的代码中的错误，状态变得不一致/损坏。</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_推荐_9"><a class="anchor" href="#_推荐_9"></a>推荐</h4>
<div class="ulist">
<ul>
<li>
<p>确保升级中使用的方法经过测试，否则容器变得不可变。</p>
</li>
<li>
<p>制定可以重新安装容器的灾难恢复策略可能会很有用。</p>
</li>
<li>
<p>请参阅“备份和恢复”部分<a href="https://www.joachim-breitner.de/blog/788-How_to_audit_an_Internet_Computer_canister">How to audit an Internet Computer canister</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_容器间调用和回滚"><a class="anchor" href="#_容器间调用和回滚"></a>容器间调用和回滚</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_不要在等待之后恐慌不要跨等待边界锁定共享资源"><a class="anchor" href="#_不要在等待之后恐慌不要跨等待边界锁定共享资源"></a>不要在等待之后恐慌，不要跨等待边界锁定共享资源</h3>
<div class="sect3">
<h4 id="_安全问题_11"><a class="anchor" href="#_安全问题_11"></a>安全问题</h4>
<div class="paragraph">
<p>恐慌和陷阱回滚罐状态。因此，任何伴随陷阱或恐慌的状态变化都是值得关注的。当进行容器间调用时，这也是一个重要的问题。如果在容器间调用的“等待”之后发生恐慌/陷阱，则状态将恢复到容器间调用回调调用之前的快照（而不是在整个调用之前！）。</p>
</div>
<div class="paragraph">
<p>这可能是例如导致以下问题：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>如果在容器间调用之前状态更改导致状态不一致，并且在容器间调用之后出现恐慌，则会导致容器状态不一致。</p>
</li>
<li>
<p>特别是，如果在容器间调用之前分配的资源（例如锁或内存）没有被释放，这可以例如导致罐子被永远锁定。</p>
</li>
<li>
<p>通常，当开发人员预期的数据未持久化时，可能会出现错误。</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_推荐_10"><a class="anchor" href="#_推荐_10"></a>推荐</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://mmapped.blog/posts/01-effective-rust-canisters.html#panic-await">Don’t panic after <code>await</code></a> (from <a href="https://mmapped.blog/posts/01-effective-rust-canisters.html">Effective Rust Canisters</a>)</p>
</li>
<li>
<p><a href="https://mmapped.blog/posts/01-effective-rust-canisters.html#dont-lock">Don&#8217;t lock shared resources across await boundaries</a> (from <a href="https://mmapped.blog/posts/01-effective-rust-canisters.html">Effective Rust Canisters</a>)</p>
</li>
<li>
<p>See also: "Inter-canister calls" section in <a href="https://www.joachim-breitner.de/blog/788-How_to_audit_an_Internet_Computer_canister">How to audit an Internet Computer canister</a></p>
</li>
<li>
<p>For context: <a href="https://docs.dfinity.systems/spec/public/#rule-message-execution">IC interface spec on message execution</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_请注意容器间调用期间状态可能会发生变化"><a class="anchor" href="#_请注意容器间调用期间状态可能会发生变化"></a>请注意，容器间调用期间状态可能会发生变化</h3>
<div class="sect3">
<h4 id="_安全问题_12"><a class="anchor" href="#_安全问题_12"></a>安全问题</h4>
<div class="paragraph">
<p>消息（但不是整个调用）以原子方式处理。 这可能会导致安全问题，例如：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Time-of-check time-of-use：在容器间调用之前检查全局状态的某些条件，并错误地假设它在调用返回时仍然保持。</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_推荐_11"><a class="anchor" href="#_推荐_11"></a>推荐</h4>
<div class="ulist">
<ul>
<li>
<p>请注意，在容器间调用期间状态可能会发生变化。 仔细检查您的代码，以免出现此类错误。</p>
</li>
<li>
<p>另请参阅：“容器间调用”部分<a href="https://www.joachim-breitner.de/blog/788-How_to_audit_an_Internet_Computer_canister">How to audit an Internet Computer canister</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_仅对可信赖的容器进行容器间调用"><a class="anchor" href="#_仅对可信赖的容器进行容器间调用"></a>仅对可信赖的容器进行容器间调用</h3>
<div class="sect3">
<h4 id="_安全问题_13"><a class="anchor" href="#_安全问题_13"></a>安全问题</h4>
<div class="ulist">
<ul>
<li>
<p>如果对潜在的恶意容器进行容器间调用，这可能会导致 DoS 问题，或者可能存在与坦率解码相关的问题。 此外，可以假定从容器调用返回的数据是可信的，但实际上并非如此。</p>
</li>
<li>
<p>如果使用回调调用容器，如果对等方没有响应，接收方可能会无限期停止，从而导致 DoS。 如果容器处于该状态，则无法再升级它。 恢复将涉及重新安装、擦除容器的状态。</p>
</li>
<li>
<p>总之，如果容器的行为取决于容器间调用响应，这可能会拒绝容器、消耗过多的资源或导致逻辑错误。</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_推荐_12"><a class="anchor" href="#_推荐_12"></a>推荐</h4>
<div class="ulist">
<ul>
<li>
<p>仅对可信赖的容器进行容器间调用。</p>
</li>
<li>
<p>清理从容器间调用返回的数据。</p>
</li>
<li>
<p>请参阅“与恶意罐交谈”部分:linkhttps://www.joachim-breitner.de/blog/788-How_to_audit_an_Internet_Computer_canister[How to audit an Internet Computer canister]</p>
</li>
<li>
<p>See <a href="https://wiki.internetcomputer.org/wiki/Current_limitations_of_the_Internet_Computer">Current limitations of the Internet Computer</a>, section "Calling potentially malicious or buggy canisters can prevent canisters from upgrading"</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_确保调用图中没有循环"><a class="anchor" href="#_确保调用图中没有循环"></a>确保调用图中没有循环</h3>
<div class="sect3">
<h4 id="_安全问题_14"><a class="anchor" href="#_安全问题_14"></a>安全问题</h4>
<div class="paragraph">
<p>调用图中的循环（例如容器 A 调用 B、B 调用 C、C 调用 A）可能导致容器死锁。</p>
</div>
</div>
<div class="sect3">
<h4 id="_推荐_13"><a class="anchor" href="#_推荐_13"></a>推荐</h4>
<div class="ulist">
<ul>
<li>
<p>避免这样的循环！</p>
</li>
<li>
<p>有关更多信息，请参阅<a href="https://wiki.internetcomputer.org/wiki/Current_limitations_of_the_Internet_Computer">Current limitations of the Internet Computer</a>, section "Loops in call graphs"</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_罐升级"><a class="anchor" href="#_罐升级"></a>罐升级</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_在升级过程中小心恐慌"><a class="anchor" href="#_在升级过程中小心恐慌"></a>在升级过程中小心恐慌</h3>
<div class="sect3">
<h4 id="_安全问题_15"><a class="anchor" href="#_安全问题_15"></a>安全问题</h4>
<div class="paragraph">
<p>如果容器在“pre_upgrade”中陷入陷阱或恐慌，这可能会导致容器永久阻塞，从而导致升级失败或根本无法升级的情况。</p>
</div>
</div>
<div class="sect3">
<h4 id="_推荐_14"><a class="anchor" href="#_推荐_14"></a>推荐</h4>
<div class="ulist">
<ul>
<li>
<p>避免在 <code>pre_upgrade</code> 挂钩中出现恐慌/陷阱，除非它确实不可恢复，因此任何无效状态都可以通过升级修复。 pre-upgrade hook 中的 panic 会阻止升级，并且由于 pre-upgrade hook 由旧代码控制，它可以永久阻止升级。</p>
</li>
<li>
<p>如果状态无效，则在 <code>post_upgrade</code> 挂钩中出现恐慌，以便可以重试升级并尝试修复无效状态。 升级后挂钩中的恐慌会中止升级，但可以使用新代码重试。</p>
</li>
<li>
<p>link：https://mmapped.blog/posts/01-effective-rust-canisters.html#test-upgrades[测试升级钩子。]（来自link：https://mmapped.blog/posts/01-effective -rust-canisters.html[有效的rust容器])</p>
</li>
<li>
<p>另请参阅有关升级的部分link：https://www.joachim-breitner.de/blog/788-How_to_audit_an_Internet_Computer_canister[如何审核互联网计算机容器]（尽管侧重于 Motoko）</p>
</li>
<li>
<p>参见link：https://wiki.internetcomputer.org/wiki/Current_limitations_of_the_Internet_Computer[互联网计算机的当前限制]，“<code>pre_upgrade</code> 挂钩中的错误”部分</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_杂项"><a class="anchor" href="#_杂项"></a>杂项</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="测试您的容器代码"><a class="anchor" href="#测试您的容器代码"></a>即使存在系统 API 调用，也可以测试您的容器代码</h3>
<div class="sect3">
<h4 id="_安全问题_16"><a class="anchor" href="#_安全问题_16"></a>安全问题</h4>
<div class="paragraph">
<p>由于容器与系统 API 交互，因此很难测试代码，因为单元测试无法调用系统 API。 这可能会导致缺少单元测试。</p>
</div>
</div>
<div class="sect3">
<h4 id="_推荐_15"><a class="anchor" href="#_推荐_15"></a>推荐</h4>
<div class="ulist">
<ul>
<li>
<p>创建不依赖于系统 API 的松散耦合模块并对它们进行单元测试。 看到这个<a href="https://mmapped.blog/posts/01-effective-rust-canisters.html#target-independent">recommendation</a> (from <a href="https://mmapped.blog/posts/01-effective-rust-canisters.html">Effective Rust Canisters</a>).</p>
</li>
<li>
<p>对于仍与系统 API 交互的部分：创建在单元测试中伪造的系统 API 的精简抽象。 见<a href="https://mmapped.blog/posts/01-effective-rust-canisters.html#target-independent">recommendation</a> (from <a href="https://mmapped.blog/posts/01-effective-rust-canisters.html">Effective Rust Canisters</a>).例如，可以按如下方式实现“运行时”，然后在测试中使用“模拟运行时”（Dimitris Sarlis 编写的代码）：</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-rust hljs" data-lang="rust">    use ic_cdk::api::{
        call::call, caller, data_certificate, id, print, time, trap,
    };

    #[async_trait]
    pub trait Runtime {
        fn caller(&amp;self) -&gt; Result&lt;Principal, String&gt;;
        fn id(&amp;self) -&gt; Principal;
        fn time(&amp;self) -&gt; u64;
        fn trap(&amp;self, message: &amp;str) -&gt; !;
        fn print(&amp;self, message: &amp;str);
        fn data_certificate(&amp;self) -&gt; Option&lt;Vec&lt;u8&gt;&gt;;
        (...)
    }

    #[async_trait]
    impl Runtime for RuntimeImpl {
        fn caller(&amp;self) -&gt; Result&lt;Principal, String&gt; {
            let caller = caller();
            // The anonymous principal is not allowed to interact with the canister.
            if caller == Principal::anonymous() {
                Err(String::from(
                    "Anonymous principal not allowed to make calls.",
                ))
            } else {
                Ok(caller)
            }
        }

        fn id(&amp;self) -&gt; Principal {
            id()
        }

        fn time(&amp;self) -&gt; u64 {
            time()
        }

        (...)

    }

    pub struct MockRuntime {
        pub caller: Principal,
        pub canister_id: Principal,
        pub time: u64,
        (...)
    }

    #[async_trait]
    impl Runtime for MockRuntime {
        fn caller(&amp;self) -&gt; Result&lt;Principal, String&gt; {
            Ok(self.caller)
        }

        fn id(&amp;self) -&gt; Principal {
            self.canister_id
        }

        fn time(&amp;self) -&gt; u64 {
            self.time
        }

        (...)

    }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_使容器构建可重现"><a class="anchor" href="#_使容器构建可重现"></a>使容器构建可重现</h3>
<div class="sect3">
<h4 id="_安全问题_17"><a class="anchor" href="#_安全问题_17"></a>安全问题</h4>
<div class="paragraph">
<p>应该可以验证容器是否按照它声称的那样做。 IC 提供已部署 WASM 模块的 SHA256 哈希。 为了使其有用，容器构建必须是可重现的。</p>
</div>
</div>
<div class="sect3">
<h4 id="_推荐_16"><a class="anchor" href="#_推荐_16"></a>推荐</h4>
<div class="paragraph">
<p>使容器构建可重现。 看到这个<a href="https://mmapped.blog/posts/01-effective-rust-canisters.html#reproducible-builds">recommendation</a> (from <a href="https://mmapped.blog/posts/01-effective-rust-canisters.html">Effective Rust Canisters</a>). See also <a href="https://smartcontracts.org/docs/developers-guide/tutorials/reproducible-builds.html">Developer docs on this</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_从您的容器中公开指标"><a class="anchor" href="#_从您的容器中公开指标"></a>从您的容器中公开指标</h3>
<div class="sect3">
<h4 id="_安全问题_18"><a class="anchor" href="#_安全问题_18"></a>安全问题</h4>
<div class="paragraph">
<p>万一受到攻击，至少能从容器中获取相关指标是一件很好的事情，例如账户数量、内部数据结构大小、稳定内存等。</p>
</div>
</div>
<div class="sect3">
<h4 id="_推荐_17"><a class="anchor" href="#_推荐_17"></a>推荐</h4>
<div class="paragraph">
<p><a href="https://mmapped.blog/posts/01-effective-rust-canisters.html#expose-metrics">Expose metrics from your canister.</a> (from <a href="https://mmapped.blog/posts/01-effective-rust-canisters.html">Effective Rust Canisters</a>)</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_不要依赖时间是严格单调的"><a class="anchor" href="#_不要依赖时间是严格单调的"></a>不要依赖时间是严格单调的</h3>
<div class="sect3">
<h4 id="_安全问题_19"><a class="anchor" href="#_安全问题_19"></a>安全问题</h4>
<div class="paragraph">
<p>从 System API 读取的时间是单调的，但不是严格单调的。因此，两个后续调用可能会返回相同的时间，这可能会在使用时间 API 时导致安全漏洞。</p>
</div>
</div>
<div class="sect3">
<h4 id="_推荐_18"><a class="anchor" href="#_推荐_18"></a>推荐</h4>
<div class="paragraph">
<p>请参阅“时间不是严格单调的”部分link：https://www.joachim-breitner.de/blog/788-How_to_audit_an_Internet_Computer_canister[如何审核 Internet 计算机容器]</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="保护-反对-排水-循环-平衡"><a class="anchor" href="#保护-反对-排水-循环-平衡"></a>防止耗尽循环余额</h3>
<div class="sect3">
<h4 id="_安全问题_20"><a class="anchor" href="#_安全问题_20"></a>安全问题</h4>
<div class="paragraph">
<p>容器为它们的燃料费，这使得它们天生就容易受到消耗所有燃料费的攻击。</p>
</div>
</div>
<div class="sect3">
<h4 id="_推荐_19"><a class="anchor" href="#_推荐_19"></a>推荐</h4>
<div class="paragraph">
<p>考虑监控、早期身份验证、容器级别的速率限制以减轻这种情况。另外，请注意，攻击者的目标是消耗大多数燃料费的调用。请参阅“循环平衡消耗攻击部分”link：https://www.joachim-breitner.de/blog/788-How_to_audit_an_Internet_Computer_canister[如何审核 Internet 计算机容器]。</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_非特定于_internet_计算机"><a class="anchor" href="#_非特定于_internet_计算机"></a>非特定于 Internet 计算机</h2>
<div class="sectionbody">
<div class="paragraph">
<p>本节中的最佳实践非常笼统，并不特定于 Internet 计算机。此列表绝不是完整的，仅列出了过去导致问题的一些非常具体的问题。</p>
</div>
<div class="sect2">
<h3 id="_验证输入"><a class="anchor" href="#_验证输入"></a>验证输入</h3>
<div class="sect3">
<h4 id="_安全问题_21"><a class="anchor" href="#_安全问题_21"></a>安全问题</h4>
<div class="paragraph">
<p>发送的数据link：https://smartcontracts.org/docs/interface-spec/index.html#http-interface[查询和更新调用]一般是不可信的。消息大小限制为几 MB。这可以例如引导以下问题：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>如果未经验证的数据在 Web UI 中呈现或显示在其他系统中，这可能导致注入攻击（例如 XSS）。</p>
</li>
<li>
<p>大尺寸的消息可能会被发送并可能存储在容器中，从而消耗过多的存储空间。</p>
</li>
<li>
<p>大输入（例如大列表或字符串）可能会触发过多的计算，导致 DoS 并消耗许多燃料费。另见link：rust-canister-development-security-best-practices.adoc#protect-against-draining-the-cycles-balance[防止耗尽燃料费余额]</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_推荐_20"><a class="anchor" href="#_推荐_20"></a>推荐</h4>
<div class="ulist">
<ul>
<li>
<p>执行输入验证，参见例如link：https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html[OWASP备忘单]。</p>
</li>
<li>
<p>“大数据攻击”部分link：https://www.joachim-breitner.de/blog/788-How_to_audit_an_Internet_Computer_canister[如何审核 Internet 计算机容器]（注意坦率的太空炸弹）</p>
</li>
<li>
<p>link：https://owasp.org/www-project-application-security-verification-standard/[ASVS] 5.1.4：验证结构化数据是强类型的，并针对定义的模式进行验证，包括允许的字符、长度和模式（例如信用卡号码或电话，或验证两个相关字段是否合理，例如检查郊区和邮政编码匹配）。</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rust不要使用不安全的_rust_代码"><a class="anchor" href="#_rust不要使用不安全的_rust_代码"></a>Rust：不要使用不安全的 Rust 代码</h3>
<div class="sect3">
<h4 id="_安全问题_22"><a class="anchor" href="#_安全问题_22"></a>安全问题</h4>
<div class="paragraph">
<p>不安全的 Rust 代码是有风险的，因为它可能会引入内存损坏问题。</p>
</div>
</div>
<div class="sect3">
<h4 id="_推荐_21"><a class="anchor" href="#_推荐_21"></a>推荐</h4>
<div class="ulist">
<ul>
<li>
<p>尽可能避免不安全的代码。</p>
</li>
<li>
<p>见link：https://anssi-fr.github.io/rust-guide/04_language.html#unsafe-code[Rust安全指南]</p>
</li>
<li>
<p>考虑link：https://docs.dfinity.systems/dfinity/spec/meta/rust.html#_avoid_unsafe_code[Dfinity Rust Guidelines]。</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rust避免整数溢出"><a class="anchor" href="#_rust避免整数溢出"></a>Rust：避免整数溢出</h3>
<div class="sect3">
<h4 id="_安全问题_23"><a class="anchor" href="#_安全问题_23"></a>安全问题</h4>
<div class="paragraph">
<p>Rust 中的整数可能会溢出。虽然这样的溢出会导致调试配置出现恐慌，但这些值只是在发布编译中默默地包裹起来。这可能会导致重大的安全问题，例如当整数用作索引、唯一 ID 或计算燃料费期或 ICP 量时。</p>
</div>
</div>
<div class="sect3">
<h4 id="_推荐_22"><a class="anchor" href="#_推荐_22"></a>推荐</h4>
<div class="ulist">
<ul>
<li>
<p>仔细检查您的代码是否存在任何可能环绕的整数运算。</p>
</li>
<li>
<p>使用这些操作的“饱和”或“已检查”变体，例如“饱和添加”、“饱和订阅”、“检查添加”、“检查订阅”等。参见例如link：https://doc.rust-lang.org/std/primitive.u32.html#method.saturating_add[Rust docs] for <code>u32</code>。</p>
</li>
<li>
<p>另见link：https://anssi-fr.github.io/rust-guide/04_language.html#integer-overflows[Rust security Guidelines on integer overflows]。</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_对于昂贵的调用考虑使用验证码或工作证明"><a class="anchor" href="#_对于昂贵的调用考虑使用验证码或工作证明"></a>对于昂贵的调用，考虑使用验证码或工作证明</h3>
<div class="sect3">
<h4 id="_安全问题_24"><a class="anchor" href="#_安全问题_24"></a>安全问题</h4>
<div class="paragraph">
<p>如果更新或查询调用很昂贵，例如就使用的内存或消耗的燃料费而言，这可能使机器人很容易使容器不可用（例如，通过填满它的存储空间）。</p>
</div>
</div>
<div class="sect3">
<h4 id="_推荐_23"><a class="anchor" href="#_推荐_23"></a>推荐</h4>
<div class="paragraph">
<p>如果 dApp 提供此类操作，请考虑使用 bot 预防技术，例如添加验证码或工作量证明。有例如link中的验证码实现：https://github.com/dfinity/internet-identity[internet identity]。</p>
</div>
</div>
</div>
</div>
</div>
</article>
<aside class="toc sidebar">
  
  <div class="toc-menu"></div>
</aside></div>
</main></div>
<footer class="footer">
    <div class="footer-container">
        <a href="https://icpleague.com"><img class="footer-logo" src="../../_/img/logo.svg"></a>
        <nav class="footer-nav">
            <!--<div class="col1">-->
            <!--<h5 class="footer-header">Developers</h5>-->
            <!--<a class="footer-link" href="http://www.dfinity.org/faq">-->
            <!--FAQ-->
            <!--</a>-->
            <!--<a class="footer-link" href="#">-->
            <!--Developers-->
            <!--</a>-->
            <!--<a class="footer-link" href="http://www.dfinity.org/data-centers">-->
            <!--Data Centers-->
            <!--</a>-->
            <!--<a class="footer-link" href="https://support.dfinity.org">-->
            <!--Support-->
            <!--</a>-->
            <!--</div>-->

            <!--<div class="col2">-->
            <!--<h5 class="footer-header">Team</h5>-->
            <!--<a class="footer-link" href="http://www.dfinity.org/foundation">-->
            <!--Foundation-->
            <!--</a>-->
            <!--<a class="footer-link" href="http://www.dfinity.org/foundation#events">-->
            <!--Events-->
            <!--</a>-->
            <!--<a class="footer-link" href="http://www.dfinity.org/careers">-->
            <!--Careers-->
            <!--</a>-->
            <!--</div>-->


            <!--<div class="col3">-->
            <!--<h5 class="footer-header">Media</h5>-->
            <!--<a class="footer-link" href="http://www.dfinity.org/media">-->
            <!--Featured Videos-->
            <!--</a>-->
            <!--<a class="footer-link" href="http://www.dfinity.org/media#featured-stories">-->
            <!--Featured Stories-->
            <!--</a>-->
            <!--<a class="footer-link" href="http://www.dfinity.org/newsletter">-->
            <!--Newsletter-->
            <!--</a>-->
            <!--</div>-->

            <div class="social-icons">
                <a class="social-icon-link" target="blank" href="https://github.com/icpleague">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd"
                              d="M12 0C5.3625 0 0 5.3625 0 12C0 17.2875 3.45 21.7875 8.2125 23.4C8.8125 23.5125 9.0375 23.1375 9.0375 22.8375C9.0375 22.5375 9.0375 21.7875 9.0375 20.8125C5.7 21.525 4.9875 19.2 4.9875 19.2C4.425 17.8125 3.6375 17.4375 3.6375 17.4375C2.55 16.6875 3.7125 16.725 3.7125 16.725C4.9125 16.8 5.55 17.9625 5.55 17.9625C6.6375 19.8 8.3625 19.275 9.0375 18.975C9.15 18.1875 9.45 17.6625 9.7875 17.3625C7.125 17.0625 4.3125 16.0125 4.3125 11.4375C4.3125 10.125 4.7625 9.075 5.55 8.2125C5.4375 7.9125 5.025 6.675 5.6625 5.025C5.6625 5.025 6.675 4.6875 8.9625 6.2625C9.9375 6 10.95 5.85 11.9625 5.85C12.975 5.85 14.025 6 14.9625 6.2625C17.25 4.725 18.2625 5.025 18.2625 5.025C18.9 6.675 18.4875 7.9125 18.375 8.2125C19.1625 9.0375 19.6125 10.125 19.6125 11.4375C19.6125 16.05 16.8 17.0625 14.1375 17.3625C14.55 17.7375 14.9625 18.45 14.9625 19.575C14.9625 21.1875 14.9625 22.4625 14.9625 22.875C14.9625 23.2125 15.1875 23.5875 15.7875 23.4375C20.55 21.7875 24 17.2875 24 12C24 5.3625 18.6375 0 12 0Z"
                              fill="#333333"/>
                    </svg>
                </a>
                <a class="social-icon-link" target="blank" href="https://medium.com/icp-league">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                                d="M22.3125 1H1.6875C1.50516 1 1.3303 1.07243 1.20136 1.20136C1.07243 1.3303 1 1.50516 1 1.6875L1 22.3125C1 22.4948 1.07243 22.6697 1.20136 22.7986C1.3303 22.9276 1.50516 23 1.6875 23H22.3125C22.4948 23 22.6697 22.9276 22.7986 22.7986C22.9276 22.6697 23 22.4948 23 22.3125V1.6875C23 1.50516 22.9276 1.3303 22.7986 1.20136C22.6697 1.07243 22.4948 1 22.3125 1V1ZM19.2768 6.21228L18.0971 7.34356C18.0471 7.38153 18.0085 7.43245 17.9854 7.4908C17.9623 7.54916 17.9557 7.61272 17.9661 7.67459V15.9875C17.9557 16.0494 17.9623 16.1129 17.9854 16.1713C18.0085 16.2296 18.0471 16.2806 18.0971 16.3185L19.2493 17.4498V17.698H13.4534V17.4498L14.6469 16.2903C14.7641 16.1731 14.7641 16.1388 14.7641 15.9593V9.24072L11.4455 17.6698H10.9987L7.13319 9.24072V14.8899C7.11729 15.0071 7.12828 15.1264 7.16533 15.2387C7.20237 15.351 7.2645 15.4535 7.347 15.5382L8.89937 17.4213V17.6695H4.49731V17.4213L6.04969 15.5382C6.13152 15.4534 6.19226 15.3505 6.22701 15.2379C6.26177 15.1253 6.26956 15.0061 6.24975 14.8899V8.35866C6.25855 8.26945 6.24627 8.17943 6.21391 8.09584C6.18155 8.01225 6.13001 7.93743 6.06344 7.87741L4.68362 6.21503V5.96684H8.96847L12.2805 13.2303L15.1924 5.96684H19.2768V6.21228Z"
                                fill="#333333"/>
                    </svg>
                </a>
                <a class="social-icon-link" target="blank" href="https://twitter.com/icpleague_com">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                                d="M23 5.33654C22.175 5.67308 21.3156 5.94231 20.4219 6.04327C21.35 5.50481 22.0719 4.62981 22.4156 3.58654C21.5562 4.09135 20.5938 4.46154 19.5625 4.66346C18.7031 3.78846 17.5344 3.25 16.2281 3.25C13.7187 3.25 11.725 5.23558 11.725 7.65865C11.725 7.99519 11.7594 8.33173 11.8281 8.66827C8.08125 8.5 4.74688 6.71635 2.54688 4.05769C2.16875 4.69712 1.92813 5.47115 1.92813 6.27885C1.92813 7.82692 2.71875 9.17308 3.92188 9.94712C3.16562 9.91346 2.47812 9.71154 1.89375 9.40865C1.89375 9.44231 1.89375 9.44231 1.89375 9.47596C1.89375 11.6298 3.44063 13.4135 5.50313 13.8173C5.125 13.9183 4.7125 13.9856 4.3 13.9856C4.025 13.9856 3.71562 13.9519 3.44062 13.9183C4.025 15.6683 5.675 16.9471 7.66875 16.9808C6.12187 18.1587 4.1625 18.8654 2.06562 18.8654C1.6875 18.8654 1.34375 18.8317 1 18.7981C2.99375 20.0096 5.36563 20.75 7.90938 20.75C16.2281 20.75 20.7656 14.0192 20.7656 8.16346C20.7656 7.96154 20.7656 7.79327 20.7656 7.59135C21.625 6.98558 22.3813 6.21154 23 5.33654Z"
                                fill="#333333"/>
                    </svg>
                </a>

                <a class="social-icon-link" target="blank" href="https://icpleague.com">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                                d="M12.0932 1C6.0727 1 1 5.83706 1 11.8085C1 12 1.00488 23 1.00488 23L12.0933 22.9901C18.1188 22.9901 23 17.9666 23 11.9951C23 6.02373 18.1188 1 12.0932 1ZM12 18.2857C11.0473 18.2857 10.1388 18.0745 9.32853 17.6916L5.34597 18.6786L6.47047 14.9956C5.98926 14.1067 5.71423 13.0853 5.71423 12C5.71423 8.52815 8.52811 5.71428 12 5.71428C15.4719 5.71428 18.2857 8.52815 18.2857 12C18.2857 15.472 15.4719 18.2857 12 18.2857Z"
                                fill="#333333"/>
                    </svg>
                </a>

                <a class="social-icon-link" target="blank" href="https://t.me/joinchat/qNiiCG5GAB9mZjc1">
                    <svg t="1645670577360" class="icon" viewBox="0 0 1024 1024" version="1.1"
                         xmlns="http://www.w3.org/2000/svg" p-id="2578" width="200" height="200">
                        <path d="M881.715 158.592l-756.48 291.712c-51.635 20.736-51.328 49.536-9.472 62.387l194.202 60.57 449.382-283.52c21.248-12.928 40.653-5.965 24.704 8.192L419.968 626.534h-0.077l0.077 0.026-13.389 200.192c19.61 0 28.288-9.011 39.296-19.635l94.336-91.725 196.224 144.947c36.173 19.917 62.157 9.677 71.168-33.51l128.794-607.053c13.184-52.864-20.173-76.8-54.682-61.184z"
                              p-id="2579"></path>
                    </svg>
                </a>

                <!--<a class="social-icon-link" target="blank" href="https://www.linkedin.com/company/dfinity">-->
                <!--<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">-->
                <!--<path fill-rule="evenodd" clip-rule="evenodd"-->
                <!--d="M1 4.35878C1 3.01688 2.03589 2 3.61924 2C5.20139 2 6.17406 3.01448 6.20507 4.35519C6.20507 5.67205 5.20139 6.71456 3.58942 6.71456H3.55841C2.00666 6.71456 1 5.67562 1 4.35878ZM17.5581 8.28158C15.1017 8.28158 13.5625 9.61217 13.278 10.5449V8.41225H8.46122C8.52324 9.54475 8.46122 21.9995 8.46122 21.9995H13.278V14.647C13.278 14.5987 13.2778 14.5505 13.2775 14.5025C13.2756 14.1436 13.2736 13.7952 13.383 13.5365C13.714 12.7194 14.4255 11.8719 15.7046 11.8719C17.3775 11.8719 18.1378 13.128 18.1378 14.9685V21.9995H23V14.4448C23 10.236 20.6056 8.28158 17.5581 8.28158ZM1.55371 8.41275H5.84157V22H1.55371V8.41275Z"-->
                <!--fill="#333333" />-->
                <!--</svg>-->

                <!--</a>-->

                <!--<a class="social-icon-link" target="blank" href="https://youtube.com/dfinity">-->
                <!--<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">-->
                <!--<path-->
                <!--d="M23.775 7.6375C23.775 7.6375 23.55 5.9875 22.8375 5.2375C21.9375 4.3 20.8875 4.2625 20.4375 4.225C17.025 4 12 4 12 4C12 4 6.975 4 3.6 4.225C3.1125 4.2625 2.1 4.3 1.2 5.2375C0.4875 5.95 0.2625 7.6375 0.2625 7.6375C0.2625 7.6375 0 9.5875 0 11.5375V13.375C0 15.325 0.225 17.275 0.225 17.275C0.225 17.275 0.45 18.925 1.1625 19.675C2.0625 20.6125 3.2625 20.6125 3.825 20.6875C5.7375 20.875 12 20.9125 12 20.9125C12 20.9125 17.025 20.9125 20.4 20.65C20.8875 20.6125 21.9 20.575 22.8 19.6375C23.5125 18.925 23.7375 17.2375 23.7375 17.2375C23.7375 17.2375 24 15.2875 24 13.3375V11.5C24 9.5875 23.775 7.6375 23.775 7.6375ZM9.525 15.55V8.8L16.0125 12.175L9.525 15.55Z"-->
                <!--fill="#333333" />-->
                <!--</svg>-->

                <!--</a>-->

            </div>
        </nav>

        <div class="legal-container">
      <span class="legal" id="year">
        © 2020 ICPLeague
      </span>
            <!--<a class="legal footer-link" href="http://www.dfinity.org/terms-of-use">-->
                <!--Terms of Use-->
            <!--</a>-->
            <!--<a class="legal footer-link" href="http://www.dfinity.org/cookie-policy">-->
                <!--Cookie Policy-->
            <!--</a>-->
            <a class="legal footer-link" href="https://twitter.com/icpleague_com">
                Privacy Policy
            </a>
        </div>

    </div>
</footer>


<script>
    var today = new Date();
    var year = today.getFullYear();
    document.getElementById("year").innerHTML = `© ${year} ICPLeague`;
</script>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script type="text/javascript"> docsearch({
    appId: 'ZM55OFXXZ2',
    apiKey: 'a7d619461c99684e30dd0b3e9d375513',
    indexName: 'smartcontracts.org',
    inputSelector: '.search-input',
    debug: false // Set debug to true if you want to inspect the dropdown
});
</script>
<!--DFINITY帮助机器人-->
<!-- Start of dfinity Zendesk Widget script -->
<!--<script id="ze-snippet" src="https://static.zdassets.com/ekr/snippet.js?key=53121947-c10a-484c-b99b-f89a9fb6f63e"> </script>-->
<!-- End of dfinity Zendesk Widget script -->

<script src="../../_/js/vendor/run_repl.js"></script>
<script type="module">
  import {CodeJar} from 'https://cdn.jsdelivr.net/npm/codejar@3.2.3/codejar.min.js';
  import {withLineNumbers} from 'https://cdn.jsdelivr.net/npm/codejar@3.2.3/linenumbers.js';
  window.CodeJar = CodeJar;
  window.withLineNumbers = withLineNumbers;
</script>
<script type="text/javascript">
async function addPackage(name, repo, version, dir) {
  const meta_url = `../../_/js/vendor/${repo}/flat`;
  const base_url = `../../_/js/vendor/${repo}`;
  const response = await fetch(meta_url);
  const json = await response.json()
  const promises = [];
  const fetchedFiles = [];
  for (const f of json.files) {
    if (f.name.startsWith(`/${dir}/`) && /\.mo$/.test(f.name)) {
      const promise = (async () => {
        const content = await (await fetch(base_url + f.name)).text();
        const stripped = name + f.name.slice(dir.length + 1);
        fetchedFiles.push(stripped);
        Motoko.saveFile(stripped, content);
      })();
      promises.push(promise);
    }
  }
  Promise.all(promises).then(() => {
    Motoko.addPackage(name, name + '/');
    console.log(`Loaded motoko library "${name}"`);
    changeCodeBlock(); // from run_repl.js
  });
}
function loadBase() {
  addPackage('base', 'dfinity/motoko-base', 'dfx-0.6.18', 'src');
}
</script>
<script async src="../../_/js/moc/moc-interpreter-0.6.11.js" onload="loadBase()">
</script>
  </body>
</html>
